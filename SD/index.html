<!DOCTYPE html>
<html>
    <head>
        <title>Control v-plotter en SD Card</title>
        <meta charset="utf-8" />
        <script src='https://code.jquery.com/jquery-3.6.3.min.js'></script>
        <script>
            function cargarRecursos(recursos) {
                function cargarSiguiente(i) {
                    if (i >= recursos.length) {                     
                        return;
                    }
                    const recurso = recursos[i];                    
                    if (recurso.tipo === 'css') {
                        $('<link>', { rel: 'stylesheet', href: recurso.archivo }).appendTo('head').on('load', function() {
                            cargarSiguiente(i + 1);
                        });
                    } else if (recurso.tipo === 'js') {
                        $.getScript(recurso.archivo)
                            .done(function() {cargarSiguiente(i + 1);})
                            .fail(function() {
                                console.warn('Error cargando JS, continuando...');
                                cargarSiguiente(i + 1);
                            });
                    } else if (recurso.tipo === 'html' && recurso.contenedor) {
                        $(recurso.contenedor).load(recurso.archivo, function() { cargarSiguiente(i + 1); });
                    } else {
                        cargarSiguiente(i + 1);
                    }
                }                
                cargarSiguiente(0);
            }
            $(function() {
                /*cdn = 'https://cdn.jsdelivr.net/gh/sebasack/v-plotter@latest/SD/';*/
                cdn = "";
                cargarRecursos([
                    { tipo: 'html', archivo: cdn + 'control.html', contenedor: '#control-placeholder' },
                    { tipo: 'css', archivo: cdn + 'styles.css' },
                    { tipo: 'js', archivo: cdn + 'util.js' },
                    { tipo: 'js', archivo: cdn + 'clase_dibujo.js'},
                    { tipo: 'js', archivo: cdn + 'plg_lineas.js'},
                    { tipo: 'js', archivo: cdn + 'captura.js'},
                    { tipo: 'js', archivo: cdn + 'control.js' }
                ]);
            });
        </script>
    </head>
    <body>
        <div id='control-placeholder'>loading html...</div>
        <a href='/' target='_self'>Cargar controlador desde CDN</a><br /><br />
        <div id='sdcard_present'></div>
    </body>
</html>
