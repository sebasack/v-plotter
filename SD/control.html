<table border="0" width="100%" >
    <tr>
        <td align="center" width="230px" valign="top">          
            
            <div class="container">
                <div class="tabs">
                    <div class="tab active" id="tab_dibujar" data-tab="dibujar">Dibujar</div>
                    <div class="tab" id="tab_captura" data-tab="captura">Captura</div>
                    <div class="tab" id="tab_config" data-tab="config">Config</div>
                </div>        
                <div class="content">
                    
                    <div class="tab-content active" id="dibujar">
                        <fieldset>
                            <legend>Interface</legend>
                            Mostrar mapa tension:<input type="checkbox" id="mostrar_mapa_tension" />    
                            <button type="button" id="recargar_config_default" >Recargar Config default</button><br/>        
                            <button type="button" id="reset_zoom" >Reset zoom</button><br/>   
                        </fieldset>                                                                
                        <fieldset>
                            <legend>Marcador</legend>
                            <table>                    
                                <tr><td align="right">X:</td><td><input id="pen_x" size="4" value="441"/></td><td width="60px" id="pen_motorA"></td></tr>                
                                <tr><td align="right">Y:</td><td><input id="pen_y" size="4" value="200" /></td><td id="pen_motorB"></td></tr>                   
                                <tr><td align="right">Up pos:</td><td><input id="upPosition" size="4" value="123" /></td><td rowspan="2">
                                    <button id="cambiar_status_pen" type="button"  title="Click para cambiar el estado" >Down</button></td></tr>
                                <tr><td align="right">Down pos:</td><td><input id="downPosition" size="4" value="90"/></td></tr>       
                                <tr><td align="right">Width:</td><td><input id="penWidth" size="4" value="0.5" /></td></tr>                                                       
                            </table>
                            <button type="button" id="return_to_home" >Return to Home</button><br/>                              
                            <button type="button" id="posicion_actual">Posicion actual</button><br/>
                            Encolar movimientos:<input type="checkbox" id="mover_gondola"  title="Encola movimiento cuando se hace doble click en una posicion"/>
                            <hr/>
                            <button type="button" id="calibrado_inicial"  title="Ponga la gondola en Home manualmente antes del calibrado inicial" >Calibrado inicial</button><br/>
                            <button type="button" id="recalibrar"  title="Busca los marcadores de posicion y vuelve la gondola a su Home" >Recalibrar</button>
                        </fieldset>  
                    </div>

                    <div class="tab-content" id="captura">
                        <select name="capturar" id="select_capturar" class="select-fijo" >                           
                        </select>
                        <fieldset id="parametros_captura">
                        </fieldset>
                        <fieldset id="parametros_importacion">
                        </fieldset>
                        <br>
                        <button type="button" id="capturar_tareas" class="boton-archivo">Capturar tareas</button>                         
                    </div>           

                    <div class="tab-content" id="config">                                    
                        <fieldset>
                            <legend>Maquina</legend>
                            <table>
                                <tr><td align="right">Ancho:</td><td><input id="machineSizeMm_x" size="4" value="882" /></td></tr>
                                <tr><td align="right">Alto:</td><td><input id="machineSizeMm_y" size="4" value="1100"/></td></tr>
                                <tr><td align="right">Mult. Pasos:</td><td><input id="stepMultiplier" size="4" value="8" /></td></tr>
                                <tr><td align="right">MM por rev.:</td><td><input id="mmPerRev" size="4" value="126"/></td></tr>
                                <tr><td align="right">Pasos x Rev.:</td><td><input id="stepsPerRev" size="4" value="4076"/></td></tr>
                                <tr><td align="right">Vel. maxima:</td><td><input id="currentMaxSpeed" size="4" value="1000" /></td></tr>
                                <tr><td align="right">Aceleracion:</td><td><input id="currentAcceleration" size="4" value="400"/></td></tr>
                            </table>
                            <button type="button" id="getMachineSpecs" >Cargar conf de la maquina</button><br/>
                            <button type="button" id="send_machine_specs">Enviar conf a la maquina</button><br/>
                            <button type="button" id="releaseMotors" >Desenergizar motores</button> <br/>     
                            <button type="button" id="restart" >Restart ESP32</button> <br/>
                        </fieldset>
                        <fieldset>
                            <legend>Pagina</legend>
                            <table>
                                <tr><td align="right">Ancho:</td><td><input id="page_width" size="4" value="210"/></td><td></td></tr>
                                <tr><td align="right">Alto:</td><td><input id="page_height" size="4" value="297"/></td><td></td></tr>
                                <tr><td align="right">posX:</td><td><input id="page_pos_x" size="4" value="336" /></td><td>
                                    <button type="button" id="centrar_pagina">Centrar</button> </td></tr>
                                <tr><td align="right">posY:</td><td><input id="page_pos_y" size="4" value="200" /></td><td></td></tr>
                            </table>
                        </fieldset>
                        <fieldset>
                            <legend>Home</legend>
                            <table>
                                <tr><td>X:<input id="home_pos_x" size="4" value="441"/></td>
                                    <td rowspan="2"><button id="set_home" type="button" >Set Home</button></td></tr>
                                <tr><td>Y:<input id="home_pos_y" size="4" value="200"/></td></tr>
                            </table>                
                        </fieldset>
                    </div>
                </div>
            </div>
        </td>

        <td align="right"  valign="top">
            <div class="canvas-container" id ="id_contenedor_canvas">
                <canvas id="machine"></canvas>
                <canvas id="lineCanvas"  width="0%" height="0%" ></canvas>
            </div>
        </td>

        <td align="center"  width="300px" valign="top">       
            <table width="100%">
                <tr><td align="left"><div id ="estado_cola" title="Haga click para pausar o activar la cola"></div></td></tr>
                <tr><td align="right">    
                         <button class="btn" id="cargar_gcode" >Importar</button>
                         <button class="btn" id="descargar_gcode" >Descargar</button>
                         <button type="button" id="limpiar_cola" >Limpiar</button>
                </td></tr>
                <tr><td align="center">
                         <input type="file" id="fileInput" style="display: none;" title="elija un archivo"  accept=".txt, .gcode, text/plain"/>
                         <input id="comando_gcode" size="36" style="text-align:left;" title="Escriba el comando GCODE y presione enter para encolarlo"/>
                </td></tr>                
            </table>
            <textarea readonly id="tareas" name="log"  style="height: 42vh;"  cols="50"></textarea>
             <table width="100%">
                <tr><td align="left">Tareas ejecutadas:</td><td align="right"><button id="limpiar_ejecutadas" type="button">Limpiar</button></td></tr>
            </table>
            <textarea readonly id="log" name="log" style="height: 42vh;"  cols="50"></textarea>
        </td>
    </tr>
</table>

<script>
    $(function() {       
        async function cargarScriptsEnOrden() {
            try {
                await $('<link>', {rel: 'stylesheet', href: `${cdn}styles.css`}).appendTo('head');
                await $.getScript(`${cdn}clases.js`);                  
                await $.getScript(`${cdn}plg_canny.js`);                 
                await $.getScript(`${cdn}plg_sobel.js`);                
                await $.getScript(`${cdn}plg_dummy.js`);              
                await $.getScript(`${cdn}captura.js`);                
                await $.getScript(`${cdn}control.js`);              
            } catch (error) {
                console.error('Error cargando scripts:', error);
            }
        }
        // Ejecutar
        cargarScriptsEnOrden();
    });
</script>
