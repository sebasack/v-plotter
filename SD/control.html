<table border="0" width="100%" height="100%">
    <tr>
        <td align="center" width="230px" valign="top">
            <div style="text-align: left; font-size: 10px" id="version">version: h02</div> <br/>       
            
            <div class="container">
                <div class="tabs">
                    <div class="tab active" data-tab="input">Dibujar</div>
                    <div class="tab" data-tab="captura">Captura</div>
                    <div class="tab" data-tab="config">Config</div>
                </div>        
                <div class="content">
                    
                    <div class="tab-content active" id="input">
                        <fieldset>
                            <legend>Interface</legend>
                            Mostrar mapa tension:<input type="checkbox" id="mostrar_mapa_tension"  onchange="guardar_parametros()"/>    
                            <button type="button" onclick="config_default()">Recargar Config default</button><br/>        
                            <button type="button" onclick="resetZoom()">Reset zoom</button><br/>   
                        </fieldset>                                                                
                        <fieldset>
                            <legend>Marcador</legend>
                            <table>                    
                                <tr><td align="right">X:</td><td><input id="pen_x" size="4" value="441" onchange="guardar_parametros()"/></td><td id="pen_motorA"></td></tr>                
                                <tr><td align="right">Y:</td><td><input id="pen_y" size="4" value="200" onchange="guardar_parametros()"/></td><td id="pen_motorB"></td></tr>                   
                                <tr><td align="right">Up pos:</td><td><input id="upPosition" size="4" value="123" onchange="guardar_parametros()"/></td><td rowspan="2">
                                    <button id="cambiar_status_pen" type="button" onclick="cambiar_status_pen()" title="Click para cambiar el estado" >Down</button></td></tr>
                                <tr><td align="right">Down pos:</td><td><input id="downPosition" size="4" value="90" onchange="guardar_parametros()"/></td></tr>       
                                <tr><td align="right">Width:</td><td><input id="penWidth" size="4" value="0.5" onchange="guardar_parametros()"/></td></tr>                                                       
                            </table>
                            <button type="button" onclick="return_to_home()">Return to Home</button><br/>                              
                            <button type="button" onclick="encolar_tarea('getPosition',update_pen_position)">Posicion actual</button><br/>
                            Encolar movimientos:<input type="checkbox" id="mover_gondola" onchange="guardar_parametros()" title="Encola movimiento cuando se hace doble click en una posicion"/>
                            <hr/>
                            <button type="button" onclick="encolar_tarea('initialCalibrate')" title="Ponga la gondola en Home manualmente antes del calibrado inicial" >Calibrado inicial</button><br/>
                            <button type="button" onclick="encolar_tarea('calibrate')" title="Busca los marcadores de posicion y vuelve la gondola a su Home" >Recalibrar</button>
                        </fieldset>  
                    </div>

                    <div class="tab-content" id="captura">
                        <fieldset>
                            <legend>Capturar imagen</legend>         

                            <input type="file" id="imageLoader"  style="display: none;" accept="image/*"   onchange="actualizarNombreArchivo()"/>
                            <button type="button" class="boton-archivo" onclick="document.getElementById('imageLoader').click()">Examinar</button>
                            <span id="nombreArchivo" class="nombre-archivo"></span>

                             <div class="slider-container">
                                <label for="umbral_slider">Umbral de detecci√≥n: <span id="umbral_value">50</span></label><br>
                                <input type="range" id="umbral_slider" min="10" max="500" value="50">
                            </div>
                             Unificar adyacentes:<input type="checkbox" id="unificar_lineas_adyacentes" checked="checked" onchange="update_lines()" title="Unifica lineas adyacentes"/><br>                               
                             <div class="slider-container">
                                <label for="grosor_slider">Grosor lineas: <span id="grosor_value">2</span></label><br>
                                <input type="range" id="grosor_slider" min="1" max="6"  step="1" value="2">
                            </div>
                             <div class="slider-container">
                                <label for="vertices_slider">Vertices eliminados: <span id="vertices_value">10%</span></label><br>
                                <input type="range" id="vertices_slider" min="0" max="95"  step="5" value="10">
                            </div>
                            <hr>
                            Mostrar imagen:<input type="checkbox" id="mostrar_imagen" checked onchange="obtener_lineas()"/><br>
                            Detalle lineas:<input type="checkbox" id="detalle_lineas" checked_ onchange="update_lines()"/>                               
                             <div class="slider-container">
                                <label for="escala_captura">Escala: <span id="escala_value">1</span></label><br>
                                <input type="range" id="escala_captura" min="0.1" max="2"  step="0.1" value="1">
                            </div>                               
                            <div id="lineas"></div> 
                            <button type="button" class="boton-archivo" onclick="importar_dibujo()">Importar</button>
                        </fieldset>
                    </div>           

                    <div class="tab-content" id="config">                                    
                        <fieldset>
                            <legend>Maquina</legend>
                            <table>
                                <tr><td align="right">Ancho:</td><td><input id="machineSizeMm_x" size="4" value="882" onchange="guardar_parametros()"/></td></tr>
                                <tr><td align="right">Alto:</td><td><input id="machineSizeMm_y" size="4" value="1100" onchange="guardar_parametros()"/></td></tr>
                                <tr><td align="right">Mult. Pasos:</td><td><input id="stepMultiplier" size="4" value="8" onchange="guardar_parametros()"/></td></tr>
                                <tr><td align="right">MM por rev.:</td><td><input id="mmPerRev" size="4" value="126" onchange="guardar_parametros()"/></td></tr>
                                <tr><td align="right">Pasos x Rev.:</td><td><input id="stepsPerRev" size="4" value="4076" onchange="guardar_parametros()"/></td></tr>
                                <tr><td align="right">Vel. maxima:</td><td><input id="currentMaxSpeed" size="4" value="1000" onchange="guardar_parametros()"/></td></tr>
                                <tr><td align="right">Aceleracion:</td><td><input id="currentAcceleration" size="4" value="400" onchange="guardar_parametros()"/></td></tr>
                            </table>
                            <button type="button" onclick="encolar_tarea('getMachineSpecs',update_machine_specs)">Cargar conf de la maquina</button><br/>
                            <button type="button" onclick="send_machine_specs()">Enviar conf a la maquina</button><br/>
                            <button type="button" onclick="encolar_tarea('releaseMotors')">Desenergizar motores</button> <br/>     
                            <button type="button" onclick="encolar_tarea('restart')">Restart ESP32</button> <br/>
                        </fieldset>
                        <fieldset>
                            <legend>Pagina</legend>
                            <table>
                                <tr><td align="right">Ancho:</td><td><input id="page_width" size="4" value="210" onchange="guardar_parametros()"/></td><td></td></tr>
                                <tr><td align="right">Alto:</td><td><input id="page_height" size="4" value="297" onchange="guardar_parametros()"/></td><td></td></tr>
                                <tr><td align="right">posX:</td><td><input id="page_pos_x" size="4" value="336" onchange="guardar_parametros()"/></td><td><button type="button" onclick="centrar_pagina_x()">Centrar</button> </td></tr>
                                <tr><td align="right">posY:</td><td><input id="page_pos_y" size="4" value="200" onchange="guardar_parametros()"/></td><td></td></tr>
                            </table>
                        </fieldset>
                        <fieldset>
                            <legend>Home</legend>
                            <table>
                                <tr><td>X:<input id="home_pos_x" size="4" value="441" onchange="guardar_parametros()"/></td>
                                    <td rowspan="2"><button type="button" onclick="set_home()">Set Home</button></td></tr>
                                <tr><td>Y:<input id="home_pos_y" size="4" value="200" onchange="guardar_parametros()"/></td></tr>
                            </table>                
                        </fieldset>
                    </div>
                </div>
            </div>
        </td>



        <td align="right"  valign="top">
            <div class="canvas-container">
                <canvas id="machine" title="Haga click para mover o la rueda para hacer zoom, doble click mueve la gondola."></canvas>
               
            <!--    <canvas id="originalCanvas"  width="0%" height="0%" ></canvas>-->
                <canvas id="lineCanvas"  width="0%" height="0%" ></canvas>
            </div>
        </td>



        <td align="center"  width="300px" valign="top">       
            <table width="100%">
                <tr><td align="left"><div id ="estado_cola" title="Haga click para pausar o activar la cola"></div></td></tr>
                <tr><td align="right">
                         <input type="file" id="fileInput" style="display: none;" title="elija un archivo"/>
                         <input id="comando_gcode" size="19" style="text-align:left;" title="Escriba el comando GCODE y presione enter para encolarlo"/>
                         <button class="btn" onclick="document.getElementById('fileInput').click()">Importar</button>
                         <button type="button" onclick="limpiar_cola()">Limpiar</button>
                    </td>
                </tr>
            </table>
            <textarea readonly id="tareas" name="log" rows="24" cols="50"></textarea>
             <table width="100%">
                <tr><td align="left">Tareas ejecutadas:</td><td align="right"><button type="button" onclick="limpiar_ejecutadas()">Limpiar</button></td></tr>
            </table>
            <textarea readonly id="log" name="log" rows="24" cols="50"></textarea>
        </td>
    </tr>
</table>